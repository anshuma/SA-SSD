/usr/local/lib/python3.8/dist-packages/mmcv/__init__.py:20: UserWarning: On January 1, 2023, MMCV will release v2.0.0, in which it will remove components related to the training process and add a data transformation module. In addition, it will rename the package names mmcv to mmcv-lite and mmcv-full to mmcv. See https://github.com/open-mmlab/mmcv/blob/master/docs/en/compatibility.md for more details.
  warnings.warn(
/workspace/git/SA-SSD/mmdet/core/bbox3d/geometry.py:76: NumbaDeprecationWarning: [1mThe keyword argument 'nopython=False' was supplied. From Numba 0.59.0 the default is being changed to True and use of 'nopython=False' will raise a warning as the argument will have no effect. See https://numba.readthedocs.io/en/stable/reference/deprecation.html#deprecation-of-object-mode-fall-back-behaviour-when-using-jit for details.[0m
  @numba.jit(nopython=False)
/workspace/git/SA-SSD/mmdet/core/bbox3d/geometry.py:176: NumbaDeprecationWarning: [1mThe keyword argument 'nopython=False' was supplied. From Numba 0.59.0 the default is being changed to True and use of 'nopython=False' will raise a warning as the argument will have no effect. See https://numba.readthedocs.io/en/stable/reference/deprecation.html#deprecation-of-object-mode-fall-back-behaviour-when-using-jit for details.[0m
  @numba.jit(nopython=False)
/workspace/git/SA-SSD/mmdet/core/bbox3d/geometry.py:189: NumbaDeprecationWarning: [1mThe keyword argument 'nopython=False' was supplied. From Numba 0.59.0 the default is being changed to True and use of 'nopython=False' will raise a warning as the argument will have no effect. See https://numba.readthedocs.io/en/stable/reference/deprecation.html#deprecation-of-object-mode-fall-back-behaviour-when-using-jit for details.[0m
  @numba.jit(nopython=False)
/workspace/git/SA-SSD/mmdet/core/bbox3d/geometry.py:230: NumbaDeprecationWarning: [1mThe 'nopython' keyword argument was not supplied to the 'numba.jit' decorator. The implicit default value for this argument is currently False, but it will be changed to True in Numba 0.59.0. See https://numba.readthedocs.io/en/stable/reference/deprecation.html#deprecation-of-object-mode-fall-back-behaviour-when-using-jit for details.[0m
  def points_in_convex_polygon_jit(points, polygon, clockwise=True):
/workspace/git/SA-SSD/mmdet/core/evaluation/kitti_eval.py:18: NumbaDeprecationWarning: [1mThe 'nopython' keyword argument was not supplied to the 'numba.jit' decorator. The implicit default value for this argument is currently False, but it will be changed to True in Numba 0.59.0. See https://numba.readthedocs.io/en/stable/reference/deprecation.html#deprecation-of-object-mode-fall-back-behaviour-when-using-jit for details.[0m
  def get_thresholds(scores: np.ndarray, num_gt, num_sample_pts=41):
2024-04-12 04:18:00,129 - INFO - Distributed training: False
2024-04-12 04:18:00,129 - INFO - Set random seed to 0
2024-04-12 04:18:03,102 - INFO - **********************Start training**********************
[40, 1600, 1408]
load 28742 Car database infos
After filter database:
load 21375 Car database infos
/workspace/git/SA-SSD/mmdet/core/bbox3d/geometry.py:76: NumbaWarning: [1m
Compilation is falling back to object mode WITH looplifting enabled because Function "corner_to_surfaces_3d" failed type inference due to: [1m[1m[1mNo implementation of function Function(<built-in function array>) found for signature:
 
 >>> array(list(list(array(float32, 2d, A))<iv=None>)<iv=None>)
 
There are 2 candidate implementations:
[1m  - Of which 2 did not match due to:
  Overload in function 'impl_np_array': File: numba/np/arrayobj.py: Line 5384.
    With argument(s): '(list(list(array(float32, 2d, A))<iv=None>)<iv=None>)':[0m
[1m   Rejected as the implementation raised a specific error:
     TypingError: Failed in nopython mode pipeline (step: nopython frontend)
   [1m[1m[1mNo implementation of function Function(<intrinsic np_array>) found for signature:
    
    >>> np_array(list(list(array(float32, 2d, A))<iv=None>)<iv=None>, none)
    
   There are 2 candidate implementations:
   [1m      - Of which 2 did not match due to:
         Intrinsic in function 'np_array': File: numba/np/arrayobj.py: Line 5358.
           With argument(s): '(list(list(array(float32, 2d, A))<iv=None>)<iv=None>, none)':[0m
   [1m       Rejected as the implementation raised a specific error:
            TypingError: [1marray(float32, 2d, A) not allowed in a homogeneous sequence[0m[0m
     raised from /usr/local/lib/python3.8/dist-packages/numba/core/typing/npydecl.py:482
   [0m
   [0m[1mDuring: resolving callee type: Function(<intrinsic np_array>)[0m
   [0m[1mDuring: typing of call at /usr/local/lib/python3.8/dist-packages/numba/np/arrayobj.py (5395)
   [0m
   [1m
   File "../../../../usr/local/lib/python3.8/dist-packages/numba/np/arrayobj.py", line 5395:[0m
   [1m    def impl(object, dtype=None):
   [1m        return np_array(object, dtype)
   [0m        [1m^[0m[0m
[0m
  raised from /usr/local/lib/python3.8/dist-packages/numba/core/typeinfer.py:1086
[0m
[0m[1mDuring: resolving callee type: Function(<built-in function array>)[0m
[0m[1mDuring: typing of call at /workspace/git/SA-SSD/mmdet/core/bbox3d/geometry.py (87)
[0m
[1m
File "../mmdet/core/bbox3d/geometry.py", line 87:[0m
[1mdef corner_to_surfaces_3d(corners):
    <source elided>
    # box_corners: [N, 8, 3], must from corner functions in this module
[1m    surfaces = np.array([
[0m    [1m^[0m[0m
[0m
  @numba.jit(nopython=False)
2024-04-12 04:18:07,174 - INFO - finding looplift candidates
/workspace/git/SA-SSD/mmdet/core/bbox3d/geometry.py:76: NumbaWarning: [1m
Compilation is falling back to object mode WITH looplifting enabled because Function "corner_to_surfaces_3d" failed type inference due to: [1m[1m[1mNo implementation of function Function(<built-in function array>) found for signature:
 
 >>> array(list(list(array(float32, 2d, A))<iv=None>)<iv=None>)
 
There are 2 candidate implementations:
[1m  - Of which 2 did not match due to:
  Overload in function 'impl_np_array': File: numba/np/arrayobj.py: Line 5384.
    With argument(s): '(list(list(array(float32, 2d, A))<iv=None>)<iv=None>)':[0m
[1m   Rejected as the implementation raised a specific error:
     TypingError: Failed in nopython mode pipeline (step: nopython frontend)
   [1m[1m[1mNo implementation of function Function(<intrinsic np_array>) found for signature:
    
    >>> np_array(list(list(array(float32, 2d, A))<iv=None>)<iv=None>, none)
    
   There are 2 candidate implementations:
   [1m      - Of which 2 did not match due to:
         Intrinsic in function 'np_array': File: numba/np/arrayobj.py: Line 5358.
           With argument(s): '(list(list(array(float32, 2d, A))<iv=None>)<iv=None>, none)':[0m
   [1m       Rejected as the implementation raised a specific error:
            TypingError: [1marray(float32, 2d, A) not allowed in a homogeneous sequence[0m[0m
     raised from /usr/local/lib/python3.8/dist-packages/numba/core/typing/npydecl.py:482
   [0m
   [0m[1mDuring: resolving callee type: Function(<intrinsic np_array>)[0m
   [0m[1mDuring: typing of call at /usr/local/lib/python3.8/dist-packages/numba/np/arrayobj.py (5395)
   [0m
   [1m
   File "../../../../usr/local/lib/python3.8/dist-packages/numba/np/arrayobj.py", line 5395:[0m
   [1m    def impl(object, dtype=None):
   [1m        return np_array(object, dtype)
   [0m        [1m^[0m[0m
[0m
  raised from /usr/local/lib/python3.8/dist-packages/numba/core/typeinfer.py:1086
[0m
[0m[1mDuring: resolving callee type: Function(<built-in function array>)[0m
[0m[1mDuring: typing of call at /workspace/git/SA-SSD/mmdet/core/bbox3d/geometry.py (87)
[0m
[1m
File "../mmdet/core/bbox3d/geometry.py", line 87:[0m
[1mdef corner_to_surfaces_3d(corners):
    <source elided>
    # box_corners: [N, 8, 3], must from corner functions in this module
[1m    surfaces = np.array([
[0m    [1m^[0m[0m
[0m
  @numba.jit(nopython=False)
2024-04-12 04:18:07,175 - INFO - finding looplift candidates
/workspace/git/SA-SSD/mmdet/core/bbox3d/geometry.py:76: NumbaWarning: [1m
Compilation is falling back to object mode WITH looplifting enabled because Function "corner_to_surfaces_3d" failed type inference due to: [1m[1m[1mNo implementation of function Function(<built-in function array>) found for signature:
 
 >>> array(list(list(array(float32, 2d, A))<iv=None>)<iv=None>)
 
There are 2 candidate implementations:
[1m  - Of which 2 did not match due to:
  Overload in function 'impl_np_array': File: numba/np/arrayobj.py: Line 5384.
    With argument(s): '(list(list(array(float32, 2d, A))<iv=None>)<iv=None>)':[0m
[1m   Rejected as the implementation raised a specific error:
     TypingError: Failed in nopython mode pipeline (step: nopython frontend)
   [1m[1m[1mNo implementation of function Function(<intrinsic np_array>) found for signature:
    
    >>> np_array(list(list(array(float32, 2d, A))<iv=None>)<iv=None>, none)
    
   There are 2 candidate implementations:
   [1m      - Of which 2 did not match due to:
         Intrinsic in function 'np_array': File: numba/np/arrayobj.py: Line 5358.
           With argument(s): '(list(list(array(float32, 2d, A))<iv=None>)<iv=None>, none)':[0m
   [1m       Rejected as the implementation raised a specific error:
            TypingError: [1marray(float32, 2d, A) not allowed in a homogeneous sequence[0m[0m
     raised from /usr/local/lib/python3.8/dist-packages/numba/core/typing/npydecl.py:482
   [0m
   [0m[1mDuring: resolving callee type: Function(<intrinsic np_array>)[0m
   [0m[1mDuring: typing of call at /usr/local/lib/python3.8/dist-packages/numba/np/arrayobj.py (5395)
   [0m
   [1m
   File "../../../../usr/local/lib/python3.8/dist-packages/numba/np/arrayobj.py", line 5395:[0m
   [1m    def impl(object, dtype=None):
   [1m        return np_array(object, dtype)
   [0m        [1m^[0m[0m
[0m
  raised from /usr/local/lib/python3.8/dist-packages/numba/core/typeinfer.py:1086
[0m
[0m[1mDuring: resolving callee type: Function(<built-in function array>)[0m
[0m[1mDuring: typing of call at /workspace/git/SA-SSD/mmdet/core/bbox3d/geometry.py (87)
[0m
[1m
File "../mmdet/core/bbox3d/geometry.py", line 87:[0m
[1mdef corner_to_surfaces_3d(corners):
    <source elided>
    # box_corners: [N, 8, 3], must from corner functions in this module
[1m    surfaces = np.array([
[0m    [1m^[0m[0m
[0m
  @numba.jit(nopython=False)
2024-04-12 04:18:07,255 - INFO - finding looplift candidates
/workspace/git/SA-SSD/mmdet/core/bbox3d/geometry.py:76: NumbaWarning: [1m
Compilation is falling back to object mode WITH looplifting enabled because Function "corner_to_surfaces_3d" failed type inference due to: [1m[1m[1mNo implementation of function Function(<built-in function array>) found for signature:
 
 >>> array(list(list(array(float32, 2d, A))<iv=None>)<iv=None>)
 
There are 2 candidate implementations:
[1m  - Of which 2 did not match due to:
  Overload in function 'impl_np_array': File: numba/np/arrayobj.py: Line 5384.
    With argument(s): '(list(list(array(float32, 2d, A))<iv=None>)<iv=None>)':[0m
[1m   Rejected as the implementation raised a specific error:
     TypingError: Failed in nopython mode pipeline (step: nopython frontend)
   [1m[1m[1mNo implementation of function Function(<intrinsic np_array>) found for signature:
    
    >>> np_array(list(list(array(float32, 2d, A))<iv=None>)<iv=None>, none)
    
   There are 2 candidate implementations:
   [1m      - Of which 2 did not match due to:
         Intrinsic in function 'np_array': File: numba/np/arrayobj.py: Line 5358.
           With argument(s): '(list(list(array(float32, 2d, A))<iv=None>)<iv=None>, none)':[0m
   [1m       Rejected as the implementation raised a specific error:
            TypingError: [1marray(float32, 2d, A) not allowed in a homogeneous sequence[0m[0m
     raised from /usr/local/lib/python3.8/dist-packages/numba/core/typing/npydecl.py:482
   [0m
   [0m[1mDuring: resolving callee type: Function(<intrinsic np_array>)[0m
   [0m[1mDuring: typing of call at /usr/local/lib/python3.8/dist-packages/numba/np/arrayobj.py (5395)
   [0m
   [1m
   File "../../../../usr/local/lib/python3.8/dist-packages/numba/np/arrayobj.py", line 5395:[0m
   [1m    def impl(object, dtype=None):
   [1m        return np_array(object, dtype)
   [0m        [1m^[0m[0m
[0m
  raised from /usr/local/lib/python3.8/dist-packages/numba/core/typeinfer.py:1086
[0m
[0m[1mDuring: resolving callee type: Function(<built-in function array>)[0m
[0m[1mDuring: typing of call at /workspace/git/SA-SSD/mmdet/core/bbox3d/geometry.py (87)
[0m
[1m
File "../mmdet/core/bbox3d/geometry.py", line 87:[0m
[1mdef corner_to_surfaces_3d(corners):
    <source elided>
    # box_corners: [N, 8, 3], must from corner functions in this module
[1m    surfaces = np.array([
[0m    [1m^[0m[0m
[0m
  @numba.jit(nopython=False)
2024-04-12 04:18:07,490 - INFO - finding looplift candidates
/usr/local/lib/python3.8/dist-packages/numba/core/object_mode_passes.py:151: NumbaWarning: [1mFunction "corner_to_surfaces_3d" was compiled in object mode without forceobj=True.
[1m
File "../mmdet/core/bbox3d/geometry.py", line 77:[0m
[1m@numba.jit(nopython=False)
[1mdef corner_to_surfaces_3d(corners):
[0m[1m^[0m[0m
[0m
  warnings.warn(errors.NumbaWarning(warn_msg,
/usr/local/lib/python3.8/dist-packages/numba/core/object_mode_passes.py:161: NumbaDeprecationWarning: [1m
Fall-back from the nopython compilation path to the object mode compilation path has been detected. This is deprecated behaviour that will be removed in Numba 0.59.0.

For more information visit https://numba.readthedocs.io/en/stable/reference/deprecation.html#deprecation-of-object-mode-fall-back-behaviour-when-using-jit
[1m
File "../mmdet/core/bbox3d/geometry.py", line 77:[0m
[1m@numba.jit(nopython=False)
[1mdef corner_to_surfaces_3d(corners):
[0m[1m^[0m[0m
[0m
  warnings.warn(errors.NumbaDeprecationWarning(msg,
2024-04-12 04:18:18,212 - INFO - finding looplift candidates
/usr/local/lib/python3.8/dist-packages/numba/core/object_mode_passes.py:151: NumbaWarning: [1mFunction "corner_to_surfaces_3d" was compiled in object mode without forceobj=True.
[1m
File "../mmdet/core/bbox3d/geometry.py", line 77:[0m
[1m@numba.jit(nopython=False)
[1mdef corner_to_surfaces_3d(corners):
[0m[1m^[0m[0m
[0m
  warnings.warn(errors.NumbaWarning(warn_msg,
/usr/local/lib/python3.8/dist-packages/numba/core/object_mode_passes.py:161: NumbaDeprecationWarning: [1m
Fall-back from the nopython compilation path to the object mode compilation path has been detected. This is deprecated behaviour that will be removed in Numba 0.59.0.

For more information visit https://numba.readthedocs.io/en/stable/reference/deprecation.html#deprecation-of-object-mode-fall-back-behaviour-when-using-jit
[1m
File "../mmdet/core/bbox3d/geometry.py", line 77:[0m
[1m@numba.jit(nopython=False)
[1mdef corner_to_surfaces_3d(corners):
[0m[1m^[0m[0m
[0m
  warnings.warn(errors.NumbaDeprecationWarning(msg,
2024-04-12 04:18:18,220 - INFO - finding looplift candidates
/usr/local/lib/python3.8/dist-packages/numba/core/object_mode_passes.py:151: NumbaWarning: [1mFunction "corner_to_surfaces_3d" was compiled in object mode without forceobj=True.
[1m
File "../mmdet/core/bbox3d/geometry.py", line 77:[0m
[1m@numba.jit(nopython=False)
[1mdef corner_to_surfaces_3d(corners):
[0m[1m^[0m[0m
[0m
  warnings.warn(errors.NumbaWarning(warn_msg,
/usr/local/lib/python3.8/dist-packages/numba/core/object_mode_passes.py:161: NumbaDeprecationWarning: [1m
Fall-back from the nopython compilation path to the object mode compilation path has been detected. This is deprecated behaviour that will be removed in Numba 0.59.0.

For more information visit https://numba.readthedocs.io/en/stable/reference/deprecation.html#deprecation-of-object-mode-fall-back-behaviour-when-using-jit
[1m
File "../mmdet/core/bbox3d/geometry.py", line 77:[0m
[1m@numba.jit(nopython=False)
[1mdef corner_to_surfaces_3d(corners):
[0m[1m^[0m[0m
[0m
  warnings.warn(errors.NumbaDeprecationWarning(msg,
2024-04-12 04:18:18,404 - INFO - finding looplift candidates
/usr/local/lib/python3.8/dist-packages/numba/core/object_mode_passes.py:151: NumbaWarning: [1mFunction "corner_to_surfaces_3d" was compiled in object mode without forceobj=True.
[1m
File "../mmdet/core/bbox3d/geometry.py", line 77:[0m
[1m@numba.jit(nopython=False)
[1mdef corner_to_surfaces_3d(corners):
[0m[1m^[0m[0m
[0m
  warnings.warn(errors.NumbaWarning(warn_msg,
/usr/local/lib/python3.8/dist-packages/numba/core/object_mode_passes.py:161: NumbaDeprecationWarning: [1m
Fall-back from the nopython compilation path to the object mode compilation path has been detected. This is deprecated behaviour that will be removed in Numba 0.59.0.

For more information visit https://numba.readthedocs.io/en/stable/reference/deprecation.html#deprecation-of-object-mode-fall-back-behaviour-when-using-jit
[1m
File "../mmdet/core/bbox3d/geometry.py", line 77:[0m
[1m@numba.jit(nopython=False)
[1mdef corner_to_surfaces_3d(corners):
[0m[1m^[0m[0m
[0m
  warnings.warn(errors.NumbaDeprecationWarning(msg,
2024-04-12 04:18:18,582 - INFO - finding looplift candidates
/workspace/git/SA-SSD/mmdet/core/bbox3d/geometry.py:210: NumbaDeprecationWarning: [1m[1m
Fall-back from the nopython compilation path to the object mode compilation path has been detected. This is deprecated behaviour that will be removed in Numba 0.59.0.

For more information visit https://numba.readthedocs.io/en/stable/reference/deprecation.html#deprecation-of-object-mode-fall-back-behaviour-when-using-jit
[1m
File "../mmdet/core/bbox3d/geometry.py", line 177:[0m
[1m@numba.jit(nopython=False)
[1mdef surface_equ_3d_jit(polygon_surfaces):
[0m[1m^[0m[0m
[0m[0m
  normal_vec, d = surface_equ_3d_jit(polygon_surfaces[:, :, :3, :])
/workspace/git/SA-SSD/mmdet/core/bbox3d/geometry.py:210: NumbaWarning: [1m[1m
Compilation is falling back to object mode WITH looplifting enabled because Function "surface_equ_3d_jit" failed type inference due to: [1m[1mUse of unsupported NumPy function 'numpy.einsum' or unsupported use of the function.
[1m
File "../mmdet/core/bbox3d/geometry.py", line 185:[0m
[1mdef surface_equ_3d_jit(polygon_surfaces):
    <source elided>
    # d = -np.inner(normal_vec, points[..., 0, :])
[1m    d = np.einsum('aij, aij->ai', normal_vec, polygon_surfaces[:, :, 0, :])
[0m    [1m^[0m[0m
[0m
[0m[1mDuring: typing of get attribute at /workspace/git/SA-SSD/mmdet/core/bbox3d/geometry.py (185)[0m
[1m
File "../mmdet/core/bbox3d/geometry.py", line 185:[0m
[1mdef surface_equ_3d_jit(polygon_surfaces):
    <source elided>
    # d = -np.inner(normal_vec, points[..., 0, :])
[1m    d = np.einsum('aij, aij->ai', normal_vec, polygon_surfaces[:, :, 0, :])
[0m    [1m^[0m[0m
[0m[0m
  normal_vec, d = surface_equ_3d_jit(polygon_surfaces[:, :, :3, :])
/workspace/git/SA-SSD/mmdet/core/bbox3d/geometry.py:210: NumbaWarning: [1m[1mFunction "surface_equ_3d_jit" was compiled in object mode without forceobj=True.
[1m
File "../mmdet/core/bbox3d/geometry.py", line 177:[0m
[1m@numba.jit(nopython=False)
[1mdef surface_equ_3d_jit(polygon_surfaces):
[0m[1m^[0m[0m
[0m[0m
  normal_vec, d = surface_equ_3d_jit(polygon_surfaces[:, :, :3, :])
/workspace/git/SA-SSD/mmdet/core/bbox3d/geometry.py:189: NumbaWarning: [1m
Compilation is falling back to object mode WITH looplifting enabled because Function "points_in_convex_polygon_3d_jit" failed type inference due to: [1m[1m[1mInvalid use of type(CPUDispatcher(<function surface_equ_3d_jit at 0x7ff2ea88fc10>)) with parameters (array(float32, 4d, A))
[0m
[0m[1mDuring: resolving callee type: type(CPUDispatcher(<function surface_equ_3d_jit at 0x7ff2ea88fc10>))[0m
[0m[1mDuring: typing of call at /workspace/git/SA-SSD/mmdet/core/bbox3d/geometry.py (210)
[0m
[1m
File "../mmdet/core/bbox3d/geometry.py", line 210:[0m
[1mdef points_in_convex_polygon_3d_jit(points,
    <source elided>
        num_surfaces = np.full((num_polygons,), 9999999, dtype=np.int64)
[1m    normal_vec, d = surface_equ_3d_jit(polygon_surfaces[:, :, :3, :])
[0m    [1m^[0m[0m
[0m
  @numba.jit(nopython=False)
2024-04-12 04:18:18,984 - INFO - finding looplift candidates
/workspace/git/SA-SSD/mmdet/core/bbox3d/geometry.py:210: NumbaDeprecationWarning: [1m[1m
Fall-back from the nopython compilation path to the object mode compilation path has been detected. This is deprecated behaviour that will be removed in Numba 0.59.0.

For more information visit https://numba.readthedocs.io/en/stable/reference/deprecation.html#deprecation-of-object-mode-fall-back-behaviour-when-using-jit
[1m
File "../mmdet/core/bbox3d/geometry.py", line 177:[0m
[1m@numba.jit(nopython=False)
[1mdef surface_equ_3d_jit(polygon_surfaces):
[0m[1m^[0m[0m
[0m[0m
  normal_vec, d = surface_equ_3d_jit(polygon_surfaces[:, :, :3, :])
/workspace/git/SA-SSD/mmdet/core/bbox3d/geometry.py:210: NumbaWarning: [1m[1m
Compilation is falling back to object mode WITH looplifting enabled because Function "surface_equ_3d_jit" failed type inference due to: [1m[1mUse of unsupported NumPy function 'numpy.einsum' or unsupported use of the function.
[1m
File "../mmdet/core/bbox3d/geometry.py", line 185:[0m
[1mdef surface_equ_3d_jit(polygon_surfaces):
    <source elided>
    # d = -np.inner(normal_vec, points[..., 0, :])
[1m    d = np.einsum('aij, aij->ai', normal_vec, polygon_surfaces[:, :, 0, :])
[0m    [1m^[0m[0m
[0m
[0m[1mDuring: typing of get attribute at /workspace/git/SA-SSD/mmdet/core/bbox3d/geometry.py (185)[0m
[1m
File "../mmdet/core/bbox3d/geometry.py", line 185:[0m
[1mdef surface_equ_3d_jit(polygon_surfaces):
    <source elided>
    # d = -np.inner(normal_vec, points[..., 0, :])
[1m    d = np.einsum('aij, aij->ai', normal_vec, polygon_surfaces[:, :, 0, :])
[0m    [1m^[0m[0m
[0m[0m
  normal_vec, d = surface_equ_3d_jit(polygon_surfaces[:, :, :3, :])
/workspace/git/SA-SSD/mmdet/core/bbox3d/geometry.py:210: NumbaWarning: [1m[1mFunction "surface_equ_3d_jit" was compiled in object mode without forceobj=True.
[1m
File "../mmdet/core/bbox3d/geometry.py", line 177:[0m
[1m@numba.jit(nopython=False)
[1mdef surface_equ_3d_jit(polygon_surfaces):
[0m[1m^[0m[0m
[0m[0m
  normal_vec, d = surface_equ_3d_jit(polygon_surfaces[:, :, :3, :])
/workspace/git/SA-SSD/mmdet/core/bbox3d/geometry.py:189: NumbaWarning: [1m
Compilation is falling back to object mode WITH looplifting enabled because Function "points_in_convex_polygon_3d_jit" failed type inference due to: [1m[1m[1mInvalid use of type(CPUDispatcher(<function surface_equ_3d_jit at 0x7ff2ea88fc10>)) with parameters (array(float32, 4d, A))
[0m
[0m[1mDuring: resolving callee type: type(CPUDispatcher(<function surface_equ_3d_jit at 0x7ff2ea88fc10>))[0m
[0m[1mDuring: typing of call at /workspace/git/SA-SSD/mmdet/core/bbox3d/geometry.py (210)
[0m
[1m
File "../mmdet/core/bbox3d/geometry.py", line 210:[0m
[1mdef points_in_convex_polygon_3d_jit(points,
    <source elided>
        num_surfaces = np.full((num_polygons,), 9999999, dtype=np.int64)
[1m    normal_vec, d = surface_equ_3d_jit(polygon_surfaces[:, :, :3, :])
[0m    [1m^[0m[0m
[0m
  @numba.jit(nopython=False)
2024-04-12 04:18:18,984 - INFO - finding looplift candidates
/workspace/git/SA-SSD/mmdet/core/bbox3d/geometry.py:210: NumbaDeprecationWarning: [1m[1m
Fall-back from the nopython compilation path to the object mode compilation path has been detected. This is deprecated behaviour that will be removed in Numba 0.59.0.

For more information visit https://numba.readthedocs.io/en/stable/reference/deprecation.html#deprecation-of-object-mode-fall-back-behaviour-when-using-jit
[1m
File "../mmdet/core/bbox3d/geometry.py", line 177:[0m
[1m@numba.jit(nopython=False)
[1mdef surface_equ_3d_jit(polygon_surfaces):
[0m[1m^[0m[0m
[0m[0m
  normal_vec, d = surface_equ_3d_jit(polygon_surfaces[:, :, :3, :])
/workspace/git/SA-SSD/mmdet/core/bbox3d/geometry.py:210: NumbaWarning: [1m[1m
Compilation is falling back to object mode WITH looplifting enabled because Function "surface_equ_3d_jit" failed type inference due to: [1m[1mUse of unsupported NumPy function 'numpy.einsum' or unsupported use of the function.
[1m
File "../mmdet/core/bbox3d/geometry.py", line 185:[0m
[1mdef surface_equ_3d_jit(polygon_surfaces):
    <source elided>
    # d = -np.inner(normal_vec, points[..., 0, :])
[1m    d = np.einsum('aij, aij->ai', normal_vec, polygon_surfaces[:, :, 0, :])
[0m    [1m^[0m[0m
[0m
[0m[1mDuring: typing of get attribute at /workspace/git/SA-SSD/mmdet/core/bbox3d/geometry.py (185)[0m
[1m
File "../mmdet/core/bbox3d/geometry.py", line 185:[0m
[1mdef surface_equ_3d_jit(polygon_surfaces):
    <source elided>
    # d = -np.inner(normal_vec, points[..., 0, :])
[1m    d = np.einsum('aij, aij->ai', normal_vec, polygon_surfaces[:, :, 0, :])
[0m    [1m^[0m[0m
[0m[0m
  normal_vec, d = surface_equ_3d_jit(polygon_surfaces[:, :, :3, :])
/workspace/git/SA-SSD/mmdet/core/bbox3d/geometry.py:210: NumbaWarning: [1m[1mFunction "surface_equ_3d_jit" was compiled in object mode without forceobj=True.
[1m
File "../mmdet/core/bbox3d/geometry.py", line 177:[0m
[1m@numba.jit(nopython=False)
[1mdef surface_equ_3d_jit(polygon_surfaces):
[0m[1m^[0m[0m
[0m[0m
  normal_vec, d = surface_equ_3d_jit(polygon_surfaces[:, :, :3, :])
/workspace/git/SA-SSD/mmdet/core/bbox3d/geometry.py:189: NumbaWarning: [1m
Compilation is falling back to object mode WITH looplifting enabled because Function "points_in_convex_polygon_3d_jit" failed type inference due to: [1m[1m[1mInvalid use of type(CPUDispatcher(<function surface_equ_3d_jit at 0x7ff2ea88fc10>)) with parameters (array(float32, 4d, A))
[0m
[0m[1mDuring: resolving callee type: type(CPUDispatcher(<function surface_equ_3d_jit at 0x7ff2ea88fc10>))[0m
[0m[1mDuring: typing of call at /workspace/git/SA-SSD/mmdet/core/bbox3d/geometry.py (210)
[0m
[1m
File "../mmdet/core/bbox3d/geometry.py", line 210:[0m
[1mdef points_in_convex_polygon_3d_jit(points,
    <source elided>
        num_surfaces = np.full((num_polygons,), 9999999, dtype=np.int64)
[1m    normal_vec, d = surface_equ_3d_jit(polygon_surfaces[:, :, :3, :])
[0m    [1m^[0m[0m
[0m
  @numba.jit(nopython=False)
2024-04-12 04:18:19,159 - INFO - finding looplift candidates
/workspace/git/SA-SSD/mmdet/core/bbox3d/geometry.py:210: NumbaDeprecationWarning: [1m[1m
Fall-back from the nopython compilation path to the object mode compilation path has been detected. This is deprecated behaviour that will be removed in Numba 0.59.0.

For more information visit https://numba.readthedocs.io/en/stable/reference/deprecation.html#deprecation-of-object-mode-fall-back-behaviour-when-using-jit
[1m
File "../mmdet/core/bbox3d/geometry.py", line 177:[0m
[1m@numba.jit(nopython=False)
[1mdef surface_equ_3d_jit(polygon_surfaces):
[0m[1m^[0m[0m
[0m[0m
  normal_vec, d = surface_equ_3d_jit(polygon_surfaces[:, :, :3, :])
/workspace/git/SA-SSD/mmdet/core/bbox3d/geometry.py:210: NumbaWarning: [1m[1m
Compilation is falling back to object mode WITH looplifting enabled because Function "surface_equ_3d_jit" failed type inference due to: [1m[1mUse of unsupported NumPy function 'numpy.einsum' or unsupported use of the function.
[1m
File "../mmdet/core/bbox3d/geometry.py", line 185:[0m
[1mdef surface_equ_3d_jit(polygon_surfaces):
    <source elided>
    # d = -np.inner(normal_vec, points[..., 0, :])
[1m    d = np.einsum('aij, aij->ai', normal_vec, polygon_surfaces[:, :, 0, :])
[0m    [1m^[0m[0m
[0m
[0m[1mDuring: typing of get attribute at /workspace/git/SA-SSD/mmdet/core/bbox3d/geometry.py (185)[0m
[1m
File "../mmdet/core/bbox3d/geometry.py", line 185:[0m
[1mdef surface_equ_3d_jit(polygon_surfaces):
    <source elided>
    # d = -np.inner(normal_vec, points[..., 0, :])
[1m    d = np.einsum('aij, aij->ai', normal_vec, polygon_surfaces[:, :, 0, :])
[0m    [1m^[0m[0m
[0m[0m
  normal_vec, d = surface_equ_3d_jit(polygon_surfaces[:, :, :3, :])
/workspace/git/SA-SSD/mmdet/core/bbox3d/geometry.py:210: NumbaWarning: [1m[1mFunction "surface_equ_3d_jit" was compiled in object mode without forceobj=True.
[1m
File "../mmdet/core/bbox3d/geometry.py", line 177:[0m
[1m@numba.jit(nopython=False)
[1mdef surface_equ_3d_jit(polygon_surfaces):
[0m[1m^[0m[0m
[0m[0m
  normal_vec, d = surface_equ_3d_jit(polygon_surfaces[:, :, :3, :])
/workspace/git/SA-SSD/mmdet/core/bbox3d/geometry.py:189: NumbaWarning: [1m
Compilation is falling back to object mode WITH looplifting enabled because Function "points_in_convex_polygon_3d_jit" failed type inference due to: [1m[1m[1mInvalid use of type(CPUDispatcher(<function surface_equ_3d_jit at 0x7ff2ea88fc10>)) with parameters (array(float32, 4d, A))
[0m
[0m[1mDuring: resolving callee type: type(CPUDispatcher(<function surface_equ_3d_jit at 0x7ff2ea88fc10>))[0m
[0m[1mDuring: typing of call at /workspace/git/SA-SSD/mmdet/core/bbox3d/geometry.py (210)
[0m
[1m
File "../mmdet/core/bbox3d/geometry.py", line 210:[0m
[1mdef points_in_convex_polygon_3d_jit(points,
    <source elided>
        num_surfaces = np.full((num_polygons,), 9999999, dtype=np.int64)
[1m    normal_vec, d = surface_equ_3d_jit(polygon_surfaces[:, :, :3, :])
[0m    [1m^[0m[0m
[0m
  @numba.jit(nopython=False)
2024-04-12 04:18:19,330 - INFO - finding looplift candidates
/workspace/git/SA-SSD/mmdet/core/bbox3d/geometry.py:189: NumbaWarning: [1m
Compilation is falling back to object mode WITHOUT looplifting enabled because Function "points_in_convex_polygon_3d_jit" failed type inference due to: [1m[1mCannot determine Numba type of <class 'numba.core.dispatcher.LiftedLoop'>[0m
[1m
File "../mmdet/core/bbox3d/geometry.py", line 210:[0m
[1mdef points_in_convex_polygon_3d_jit(points,
    <source elided>
        num_surfaces = np.full((num_polygons,), 9999999, dtype=np.int64)
[1m    normal_vec, d = surface_equ_3d_jit(polygon_surfaces[:, :, :3, :])
[0m    [1m^[0m[0m
[0m[0m
  @numba.jit(nopython=False)
/usr/local/lib/python3.8/dist-packages/numba/core/object_mode_passes.py:151: NumbaWarning: [1mFunction "points_in_convex_polygon_3d_jit" was compiled in object mode without forceobj=True, but has lifted loops.
[1m
File "../mmdet/core/bbox3d/geometry.py", line 189:[0m
[1mdef surface_equ_3d_jit(polygon_surfaces):
    <source elided>

[1m@numba.jit(nopython=False)
[0m[1m^[0m[0m
[0m
  warnings.warn(errors.NumbaWarning(warn_msg,
/usr/local/lib/python3.8/dist-packages/numba/core/object_mode_passes.py:161: NumbaDeprecationWarning: [1m
Fall-back from the nopython compilation path to the object mode compilation path has been detected. This is deprecated behaviour that will be removed in Numba 0.59.0.

For more information visit https://numba.readthedocs.io/en/stable/reference/deprecation.html#deprecation-of-object-mode-fall-back-behaviour-when-using-jit
[1m
File "../mmdet/core/bbox3d/geometry.py", line 189:[0m
[1mdef surface_equ_3d_jit(polygon_surfaces):
    <source elided>

[1m@numba.jit(nopython=False)
[0m[1m^[0m[0m
[0m
  warnings.warn(errors.NumbaDeprecationWarning(msg,
/workspace/git/SA-SSD/mmdet/core/bbox3d/geometry.py:189: NumbaWarning: [1m
Compilation is falling back to object mode WITHOUT looplifting enabled because Function "points_in_convex_polygon_3d_jit" failed type inference due to: [1m[1m[1mInvalid use of type(CPUDispatcher(<function surface_equ_3d_jit at 0x7ff2ea88fc10>)) with parameters (array(float32, 4d, A))
[0m
[0m[1mDuring: resolving callee type: type(CPUDispatcher(<function surface_equ_3d_jit at 0x7ff2ea88fc10>))[0m
[0m[1mDuring: typing of call at /workspace/git/SA-SSD/mmdet/core/bbox3d/geometry.py (210)
[0m
[1m
File "../mmdet/core/bbox3d/geometry.py", line 210:[0m
[1mdef points_in_convex_polygon_3d_jit(points,
    <source elided>
        num_surfaces = np.full((num_polygons,), 9999999, dtype=np.int64)
[1m    normal_vec, d = surface_equ_3d_jit(polygon_surfaces[:, :, :3, :])
[0m    [1m^[0m[0m
[0m
  @numba.jit(nopython=False)
/usr/local/lib/python3.8/dist-packages/numba/core/object_mode_passes.py:151: NumbaWarning: [1mFunction "points_in_convex_polygon_3d_jit" was compiled in object mode without forceobj=True.
[1m
File "../mmdet/core/bbox3d/geometry.py", line 210:[0m
[1mdef points_in_convex_polygon_3d_jit(points,
    <source elided>
        num_surfaces = np.full((num_polygons,), 9999999, dtype=np.int64)
[1m    normal_vec, d = surface_equ_3d_jit(polygon_surfaces[:, :, :3, :])
[0m    [1m^[0m[0m
[0m
  warnings.warn(errors.NumbaWarning(warn_msg,
/usr/local/lib/python3.8/dist-packages/numba/core/object_mode_passes.py:161: NumbaDeprecationWarning: [1m
Fall-back from the nopython compilation path to the object mode compilation path has been detected. This is deprecated behaviour that will be removed in Numba 0.59.0.

For more information visit https://numba.readthedocs.io/en/stable/reference/deprecation.html#deprecation-of-object-mode-fall-back-behaviour-when-using-jit
[1m
File "../mmdet/core/bbox3d/geometry.py", line 210:[0m
[1mdef points_in_convex_polygon_3d_jit(points,
    <source elided>
        num_surfaces = np.full((num_polygons,), 9999999, dtype=np.int64)
[1m    normal_vec, d = surface_equ_3d_jit(polygon_surfaces[:, :, :3, :])
[0m    [1m^[0m[0m
[0m
  warnings.warn(errors.NumbaDeprecationWarning(msg,
/workspace/git/SA-SSD/mmdet/core/point_cloud/point_augmentor.py:58: NumbaPerformanceWarning: [1m[1m'@' is faster on contiguous arrays, called on (Array(float32, 2, 'A', False, aligned=True), Array(float32, 2, 'C', False, aligned=True))[0m[0m
  points[i:i + 1, :3] = points[i:i + 1, :3] @ rot_mat_T[j]
/workspace/git/SA-SSD/mmdet/core/bbox3d/geometry.py:229: NumbaWarning: [1m
Compilation is falling back to object mode WITH looplifting enabled because Function "points_in_convex_polygon_jit" failed type inference due to: [1m[1mNo implementation of function Function(<built-in function getitem>) found for signature:
 
 >>> getitem(array(float32, 3d, C), Tuple(slice<a:b>, list(int64)<iv=None>, slice<a:b>))
 
There are 22 candidate implementations:
[1m   - Of which 20 did not match due to:
   Overload of function 'getitem': File: <numerous>: Line N/A.
     With argument(s): '(array(float32, 3d, C), Tuple(slice<a:b>, list(int64)<iv=None>, slice<a:b>))':[0m
[1m    No match.[0m
[1m   - Of which 2 did not match due to:
   Overload in function 'GetItemBuffer.generic': File: numba/core/typing/arraydecl.py: Line 209.
     With argument(s): '(array(float32, 3d, C), Tuple(slice<a:b>, list(int64)<iv=None>, slice<a:b>))':[0m
[1m    Rejected as the implementation raised a specific error:
      NumbaTypeError: [1mUnsupported array index type list(int64)<iv=None> in Tuple(slice<a:b>, list(int64)<iv=None>, slice<a:b>)[0m[0m
  raised from /usr/local/lib/python3.8/dist-packages/numba/core/typing/arraydecl.py:102
[0m
[0m[1mDuring: typing of intrinsic-call at /workspace/git/SA-SSD/mmdet/core/bbox3d/geometry.py (244)[0m
[1m
File "../mmdet/core/bbox3d/geometry.py", line 244:[0m
[1mdef points_in_convex_polygon_jit(points, polygon, clockwise=True):
    <source elided>
    if clockwise:
[1m        vec1 = polygon - polygon[:, [num_points_of_polygon - 1] +
[0m        [1m^[0m[0m
[0m
  @numba.jit
2024-04-12 04:18:25,613 - INFO - finding looplift candidates
/workspace/git/SA-SSD/mmdet/core/bbox3d/geometry.py:189: NumbaWarning: [1m
Compilation is falling back to object mode WITHOUT looplifting enabled because Function "points_in_convex_polygon_3d_jit" failed type inference due to: [1m[1mCannot determine Numba type of <class 'numba.core.dispatcher.LiftedLoop'>[0m
[1m
File "../mmdet/core/bbox3d/geometry.py", line 210:[0m
[1mdef points_in_convex_polygon_3d_jit(points,
    <source elided>
        num_surfaces = np.full((num_polygons,), 9999999, dtype=np.int64)
[1m    normal_vec, d = surface_equ_3d_jit(polygon_surfaces[:, :, :3, :])
[0m    [1m^[0m[0m
[0m[0m
  @numba.jit(nopython=False)
/usr/local/lib/python3.8/dist-packages/numba/core/object_mode_passes.py:151: NumbaWarning: [1mFunction "points_in_convex_polygon_3d_jit" was compiled in object mode without forceobj=True, but has lifted loops.
[1m
File "../mmdet/core/bbox3d/geometry.py", line 189:[0m
[1mdef surface_equ_3d_jit(polygon_surfaces):
    <source elided>

[1m@numba.jit(nopython=False)
[0m[1m^[0m[0m
[0m
  warnings.warn(errors.NumbaWarning(warn_msg,
/usr/local/lib/python3.8/dist-packages/numba/core/object_mode_passes.py:161: NumbaDeprecationWarning: [1m
Fall-back from the nopython compilation path to the object mode compilation path has been detected. This is deprecated behaviour that will be removed in Numba 0.59.0.

For more information visit https://numba.readthedocs.io/en/stable/reference/deprecation.html#deprecation-of-object-mode-fall-back-behaviour-when-using-jit
[1m
File "../mmdet/core/bbox3d/geometry.py", line 189:[0m
[1mdef surface_equ_3d_jit(polygon_surfaces):
    <source elided>

[1m@numba.jit(nopython=False)
[0m[1m^[0m[0m
[0m
  warnings.warn(errors.NumbaDeprecationWarning(msg,
/workspace/git/SA-SSD/mmdet/core/bbox3d/geometry.py:189: NumbaWarning: [1m
Compilation is falling back to object mode WITHOUT looplifting enabled because Function "points_in_convex_polygon_3d_jit" failed type inference due to: [1m[1m[1mInvalid use of type(CPUDispatcher(<function surface_equ_3d_jit at 0x7ff2ea88fc10>)) with parameters (array(float32, 4d, A))
[0m
[0m[1mDuring: resolving callee type: type(CPUDispatcher(<function surface_equ_3d_jit at 0x7ff2ea88fc10>))[0m
[0m[1mDuring: typing of call at /workspace/git/SA-SSD/mmdet/core/bbox3d/geometry.py (210)
[0m
[1m
File "../mmdet/core/bbox3d/geometry.py", line 210:[0m
[1mdef points_in_convex_polygon_3d_jit(points,
    <source elided>
        num_surfaces = np.full((num_polygons,), 9999999, dtype=np.int64)
[1m    normal_vec, d = surface_equ_3d_jit(polygon_surfaces[:, :, :3, :])
[0m    [1m^[0m[0m
[0m
  @numba.jit(nopython=False)
/usr/local/lib/python3.8/dist-packages/numba/core/object_mode_passes.py:151: NumbaWarning: [1mFunction "points_in_convex_polygon_3d_jit" was compiled in object mode without forceobj=True.
[1m
File "../mmdet/core/bbox3d/geometry.py", line 210:[0m
[1mdef points_in_convex_polygon_3d_jit(points,
    <source elided>
        num_surfaces = np.full((num_polygons,), 9999999, dtype=np.int64)
[1m    normal_vec, d = surface_equ_3d_jit(polygon_surfaces[:, :, :3, :])
[0m    [1m^[0m[0m
[0m
  warnings.warn(errors.NumbaWarning(warn_msg,
/usr/local/lib/python3.8/dist-packages/numba/core/object_mode_passes.py:161: NumbaDeprecationWarning: [1m
Fall-back from the nopython compilation path to the object mode compilation path has been detected. This is deprecated behaviour that will be removed in Numba 0.59.0.

For more information visit https://numba.readthedocs.io/en/stable/reference/deprecation.html#deprecation-of-object-mode-fall-back-behaviour-when-using-jit
[1m
File "../mmdet/core/bbox3d/geometry.py", line 210:[0m
[1mdef points_in_convex_polygon_3d_jit(points,
    <source elided>
        num_surfaces = np.full((num_polygons,), 9999999, dtype=np.int64)
[1m    normal_vec, d = surface_equ_3d_jit(polygon_surfaces[:, :, :3, :])
[0m    [1m^[0m[0m
[0m
  warnings.warn(errors.NumbaDeprecationWarning(msg,
/workspace/git/SA-SSD/mmdet/core/point_cloud/point_augmentor.py:58: NumbaPerformanceWarning: [1m[1m'@' is faster on contiguous arrays, called on (Array(float32, 2, 'A', False, aligned=True), Array(float32, 2, 'C', False, aligned=True))[0m[0m
  points[i:i + 1, :3] = points[i:i + 1, :3] @ rot_mat_T[j]
/workspace/git/SA-SSD/mmdet/core/bbox3d/geometry.py:229: NumbaWarning: [1m
Compilation is falling back to object mode WITH looplifting enabled because Function "points_in_convex_polygon_jit" failed type inference due to: [1m[1mNo implementation of function Function(<built-in function getitem>) found for signature:
 
 >>> getitem(array(float32, 3d, C), Tuple(slice<a:b>, list(int64)<iv=None>, slice<a:b>))
 
There are 22 candidate implementations:
[1m   - Of which 20 did not match due to:
   Overload of function 'getitem': File: <numerous>: Line N/A.
     With argument(s): '(array(float32, 3d, C), Tuple(slice<a:b>, list(int64)<iv=None>, slice<a:b>))':[0m
[1m    No match.[0m
[1m   - Of which 2 did not match due to:
   Overload in function 'GetItemBuffer.generic': File: numba/core/typing/arraydecl.py: Line 209.
     With argument(s): '(array(float32, 3d, C), Tuple(slice<a:b>, list(int64)<iv=None>, slice<a:b>))':[0m
[1m    Rejected as the implementation raised a specific error:
      NumbaTypeError: [1mUnsupported array index type list(int64)<iv=None> in Tuple(slice<a:b>, list(int64)<iv=None>, slice<a:b>)[0m[0m
  raised from /usr/local/lib/python3.8/dist-packages/numba/core/typing/arraydecl.py:102
[0m
[0m[1mDuring: typing of intrinsic-call at /workspace/git/SA-SSD/mmdet/core/bbox3d/geometry.py (244)[0m
[1m
File "../mmdet/core/bbox3d/geometry.py", line 244:[0m
[1mdef points_in_convex_polygon_jit(points, polygon, clockwise=True):
    <source elided>
    if clockwise:
[1m        vec1 = polygon - polygon[:, [num_points_of_polygon - 1] +
[0m        [1m^[0m[0m
[0m
  @numba.jit
2024-04-12 04:18:25,630 - INFO - finding looplift candidates
/workspace/git/SA-SSD/mmdet/core/bbox3d/geometry.py:189: NumbaWarning: [1m
Compilation is falling back to object mode WITHOUT looplifting enabled because Function "points_in_convex_polygon_3d_jit" failed type inference due to: [1m[1mCannot determine Numba type of <class 'numba.core.dispatcher.LiftedLoop'>[0m
[1m
File "../mmdet/core/bbox3d/geometry.py", line 210:[0m
[1mdef points_in_convex_polygon_3d_jit(points,
    <source elided>
        num_surfaces = np.full((num_polygons,), 9999999, dtype=np.int64)
[1m    normal_vec, d = surface_equ_3d_jit(polygon_surfaces[:, :, :3, :])
[0m    [1m^[0m[0m
[0m[0m
  @numba.jit(nopython=False)
/usr/local/lib/python3.8/dist-packages/numba/core/object_mode_passes.py:151: NumbaWarning: [1mFunction "points_in_convex_polygon_3d_jit" was compiled in object mode without forceobj=True, but has lifted loops.
[1m
File "../mmdet/core/bbox3d/geometry.py", line 189:[0m
[1mdef surface_equ_3d_jit(polygon_surfaces):
    <source elided>

[1m@numba.jit(nopython=False)
[0m[1m^[0m[0m
[0m
  warnings.warn(errors.NumbaWarning(warn_msg,
/usr/local/lib/python3.8/dist-packages/numba/core/object_mode_passes.py:161: NumbaDeprecationWarning: [1m
Fall-back from the nopython compilation path to the object mode compilation path has been detected. This is deprecated behaviour that will be removed in Numba 0.59.0.

For more information visit https://numba.readthedocs.io/en/stable/reference/deprecation.html#deprecation-of-object-mode-fall-back-behaviour-when-using-jit
[1m
File "../mmdet/core/bbox3d/geometry.py", line 189:[0m
[1mdef surface_equ_3d_jit(polygon_surfaces):
    <source elided>

[1m@numba.jit(nopython=False)
[0m[1m^[0m[0m
[0m
  warnings.warn(errors.NumbaDeprecationWarning(msg,
/workspace/git/SA-SSD/mmdet/core/bbox3d/geometry.py:189: NumbaWarning: [1m
Compilation is falling back to object mode WITHOUT looplifting enabled because Function "points_in_convex_polygon_3d_jit" failed type inference due to: [1m[1m[1mInvalid use of type(CPUDispatcher(<function surface_equ_3d_jit at 0x7ff2ea88fc10>)) with parameters (array(float32, 4d, A))
[0m
[0m[1mDuring: resolving callee type: type(CPUDispatcher(<function surface_equ_3d_jit at 0x7ff2ea88fc10>))[0m
[0m[1mDuring: typing of call at /workspace/git/SA-SSD/mmdet/core/bbox3d/geometry.py (210)
[0m
[1m
File "../mmdet/core/bbox3d/geometry.py", line 210:[0m
[1mdef points_in_convex_polygon_3d_jit(points,
    <source elided>
        num_surfaces = np.full((num_polygons,), 9999999, dtype=np.int64)
[1m    normal_vec, d = surface_equ_3d_jit(polygon_surfaces[:, :, :3, :])
[0m    [1m^[0m[0m
[0m
  @numba.jit(nopython=False)
/usr/local/lib/python3.8/dist-packages/numba/core/object_mode_passes.py:151: NumbaWarning: [1mFunction "points_in_convex_polygon_3d_jit" was compiled in object mode without forceobj=True.
[1m
File "../mmdet/core/bbox3d/geometry.py", line 210:[0m
[1mdef points_in_convex_polygon_3d_jit(points,
    <source elided>
        num_surfaces = np.full((num_polygons,), 9999999, dtype=np.int64)
[1m    normal_vec, d = surface_equ_3d_jit(polygon_surfaces[:, :, :3, :])
[0m    [1m^[0m[0m
[0m
  warnings.warn(errors.NumbaWarning(warn_msg,
/usr/local/lib/python3.8/dist-packages/numba/core/object_mode_passes.py:161: NumbaDeprecationWarning: [1m
Fall-back from the nopython compilation path to the object mode compilation path has been detected. This is deprecated behaviour that will be removed in Numba 0.59.0.

For more information visit https://numba.readthedocs.io/en/stable/reference/deprecation.html#deprecation-of-object-mode-fall-back-behaviour-when-using-jit
[1m
File "../mmdet/core/bbox3d/geometry.py", line 210:[0m
[1mdef points_in_convex_polygon_3d_jit(points,
    <source elided>
        num_surfaces = np.full((num_polygons,), 9999999, dtype=np.int64)
[1m    normal_vec, d = surface_equ_3d_jit(polygon_surfaces[:, :, :3, :])
[0m    [1m^[0m[0m
[0m
  warnings.warn(errors.NumbaDeprecationWarning(msg,
/workspace/git/SA-SSD/mmdet/core/point_cloud/point_augmentor.py:58: NumbaPerformanceWarning: [1m[1m'@' is faster on contiguous arrays, called on (Array(float32, 2, 'A', False, aligned=True), Array(float32, 2, 'C', False, aligned=True))[0m[0m
  points[i:i + 1, :3] = points[i:i + 1, :3] @ rot_mat_T[j]
/workspace/git/SA-SSD/mmdet/core/bbox3d/geometry.py:229: NumbaWarning: [1m
Compilation is falling back to object mode WITH looplifting enabled because Function "points_in_convex_polygon_jit" failed type inference due to: [1m[1mNo implementation of function Function(<built-in function getitem>) found for signature:
 
 >>> getitem(array(float32, 3d, C), Tuple(slice<a:b>, list(int64)<iv=None>, slice<a:b>))
 
There are 22 candidate implementations:
[1m   - Of which 20 did not match due to:
   Overload of function 'getitem': File: <numerous>: Line N/A.
     With argument(s): '(array(float32, 3d, C), Tuple(slice<a:b>, list(int64)<iv=None>, slice<a:b>))':[0m
[1m    No match.[0m
[1m   - Of which 2 did not match due to:
   Overload in function 'GetItemBuffer.generic': File: numba/core/typing/arraydecl.py: Line 209.
     With argument(s): '(array(float32, 3d, C), Tuple(slice<a:b>, list(int64)<iv=None>, slice<a:b>))':[0m
[1m    Rejected as the implementation raised a specific error:
      NumbaTypeError: [1mUnsupported array index type list(int64)<iv=None> in Tuple(slice<a:b>, list(int64)<iv=None>, slice<a:b>)[0m[0m
  raised from /usr/local/lib/python3.8/dist-packages/numba/core/typing/arraydecl.py:102
[0m
[0m[1mDuring: typing of intrinsic-call at /workspace/git/SA-SSD/mmdet/core/bbox3d/geometry.py (244)[0m
[1m
File "../mmdet/core/bbox3d/geometry.py", line 244:[0m
[1mdef points_in_convex_polygon_jit(points, polygon, clockwise=True):
    <source elided>
    if clockwise:
[1m        vec1 = polygon - polygon[:, [num_points_of_polygon - 1] +
[0m        [1m^[0m[0m
[0m
  @numba.jit
2024-04-12 04:18:25,732 - INFO - finding looplift candidates
/workspace/git/SA-SSD/mmdet/core/bbox3d/geometry.py:189: NumbaWarning: [1m
Compilation is falling back to object mode WITHOUT looplifting enabled because Function "points_in_convex_polygon_3d_jit" failed type inference due to: [1m[1mCannot determine Numba type of <class 'numba.core.dispatcher.LiftedLoop'>[0m
[1m
File "../mmdet/core/bbox3d/geometry.py", line 210:[0m
[1mdef points_in_convex_polygon_3d_jit(points,
    <source elided>
        num_surfaces = np.full((num_polygons,), 9999999, dtype=np.int64)
[1m    normal_vec, d = surface_equ_3d_jit(polygon_surfaces[:, :, :3, :])
[0m    [1m^[0m[0m
[0m[0m
  @numba.jit(nopython=False)
/usr/local/lib/python3.8/dist-packages/numba/core/object_mode_passes.py:151: NumbaWarning: [1mFunction "points_in_convex_polygon_3d_jit" was compiled in object mode without forceobj=True, but has lifted loops.
[1m
File "../mmdet/core/bbox3d/geometry.py", line 189:[0m
[1mdef surface_equ_3d_jit(polygon_surfaces):
    <source elided>

[1m@numba.jit(nopython=False)
[0m[1m^[0m[0m
[0m
  warnings.warn(errors.NumbaWarning(warn_msg,
/usr/local/lib/python3.8/dist-packages/numba/core/object_mode_passes.py:161: NumbaDeprecationWarning: [1m
Fall-back from the nopython compilation path to the object mode compilation path has been detected. This is deprecated behaviour that will be removed in Numba 0.59.0.

For more information visit https://numba.readthedocs.io/en/stable/reference/deprecation.html#deprecation-of-object-mode-fall-back-behaviour-when-using-jit
[1m
File "../mmdet/core/bbox3d/geometry.py", line 189:[0m
[1mdef surface_equ_3d_jit(polygon_surfaces):
    <source elided>

[1m@numba.jit(nopython=False)
[0m[1m^[0m[0m
[0m
  warnings.warn(errors.NumbaDeprecationWarning(msg,
/workspace/git/SA-SSD/mmdet/core/bbox3d/geometry.py:189: NumbaWarning: [1m
Compilation is falling back to object mode WITHOUT looplifting enabled because Function "points_in_convex_polygon_3d_jit" failed type inference due to: [1m[1m[1mInvalid use of type(CPUDispatcher(<function surface_equ_3d_jit at 0x7ff2ea88fc10>)) with parameters (array(float32, 4d, A))
[0m
[0m[1mDuring: resolving callee type: type(CPUDispatcher(<function surface_equ_3d_jit at 0x7ff2ea88fc10>))[0m
[0m[1mDuring: typing of call at /workspace/git/SA-SSD/mmdet/core/bbox3d/geometry.py (210)
[0m
[1m
File "../mmdet/core/bbox3d/geometry.py", line 210:[0m
[1mdef points_in_convex_polygon_3d_jit(points,
    <source elided>
        num_surfaces = np.full((num_polygons,), 9999999, dtype=np.int64)
[1m    normal_vec, d = surface_equ_3d_jit(polygon_surfaces[:, :, :3, :])
[0m    [1m^[0m[0m
[0m
  @numba.jit(nopython=False)
/usr/local/lib/python3.8/dist-packages/numba/core/object_mode_passes.py:151: NumbaWarning: [1mFunction "points_in_convex_polygon_3d_jit" was compiled in object mode without forceobj=True.
[1m
File "../mmdet/core/bbox3d/geometry.py", line 210:[0m
[1mdef points_in_convex_polygon_3d_jit(points,
    <source elided>
        num_surfaces = np.full((num_polygons,), 9999999, dtype=np.int64)
[1m    normal_vec, d = surface_equ_3d_jit(polygon_surfaces[:, :, :3, :])
[0m    [1m^[0m[0m
[0m
  warnings.warn(errors.NumbaWarning(warn_msg,
/usr/local/lib/python3.8/dist-packages/numba/core/object_mode_passes.py:161: NumbaDeprecationWarning: [1m
Fall-back from the nopython compilation path to the object mode compilation path has been detected. This is deprecated behaviour that will be removed in Numba 0.59.0.

For more information visit https://numba.readthedocs.io/en/stable/reference/deprecation.html#deprecation-of-object-mode-fall-back-behaviour-when-using-jit
[1m
File "../mmdet/core/bbox3d/geometry.py", line 210:[0m
[1mdef points_in_convex_polygon_3d_jit(points,
    <source elided>
        num_surfaces = np.full((num_polygons,), 9999999, dtype=np.int64)
[1m    normal_vec, d = surface_equ_3d_jit(polygon_surfaces[:, :, :3, :])
[0m    [1m^[0m[0m
[0m
  warnings.warn(errors.NumbaDeprecationWarning(msg,
/workspace/git/SA-SSD/mmdet/core/point_cloud/point_augmentor.py:58: NumbaPerformanceWarning: [1m[1m'@' is faster on contiguous arrays, called on (Array(float32, 2, 'A', False, aligned=True), Array(float32, 2, 'C', False, aligned=True))[0m[0m
  points[i:i + 1, :3] = points[i:i + 1, :3] @ rot_mat_T[j]
/workspace/git/SA-SSD/mmdet/core/bbox3d/geometry.py:229: NumbaWarning: [1m
Compilation is falling back to object mode WITH looplifting enabled because Function "points_in_convex_polygon_jit" failed type inference due to: [1m[1mNo implementation of function Function(<built-in function getitem>) found for signature:
 
 >>> getitem(array(float32, 3d, C), Tuple(slice<a:b>, list(int64)<iv=None>, slice<a:b>))
 
There are 22 candidate implementations:
[1m   - Of which 20 did not match due to:
   Overload of function 'getitem': File: <numerous>: Line N/A.
     With argument(s): '(array(float32, 3d, C), Tuple(slice<a:b>, list(int64)<iv=None>, slice<a:b>))':[0m
[1m    No match.[0m
[1m   - Of which 2 did not match due to:
   Overload in function 'GetItemBuffer.generic': File: numba/core/typing/arraydecl.py: Line 209.
     With argument(s): '(array(float32, 3d, C), Tuple(slice<a:b>, list(int64)<iv=None>, slice<a:b>))':[0m
[1m    Rejected as the implementation raised a specific error:
      NumbaTypeError: [1mUnsupported array index type list(int64)<iv=None> in Tuple(slice<a:b>, list(int64)<iv=None>, slice<a:b>)[0m[0m
  raised from /usr/local/lib/python3.8/dist-packages/numba/core/typing/arraydecl.py:102
[0m
[0m[1mDuring: typing of intrinsic-call at /workspace/git/SA-SSD/mmdet/core/bbox3d/geometry.py (244)[0m
[1m
File "../mmdet/core/bbox3d/geometry.py", line 244:[0m
[1mdef points_in_convex_polygon_jit(points, polygon, clockwise=True):
    <source elided>
    if clockwise:
[1m        vec1 = polygon - polygon[:, [num_points_of_polygon - 1] +
[0m        [1m^[0m[0m
[0m
  @numba.jit
2024-04-12 04:18:25,968 - INFO - finding looplift candidates
2024-04-12 04:18:49,049 - INFO - epoch[1][20/1856]: lr: 0.000300, aux_loss_cls: 0.265689, aux_loss_reg: 0.946331, rpn_loc_loss: 4.251702, rpn_cls_loss: 5.985203, rpn_dir_loss: 0.156354, loss_cls: 28.619994, loss: 40.225271
2024-04-12 04:19:09,888 - INFO - epoch[1][40/1856]: lr: 0.000300, aux_loss_cls: 0.214141, aux_loss_reg: 0.885390, rpn_loc_loss: 1.901459, rpn_cls_loss: 0.804134, rpn_dir_loss: 0.138698, loss_cls: 7.012362, loss: 10.956184
2024-04-12 04:19:29,691 - INFO - epoch[1][60/1856]: lr: 0.000300, aux_loss_cls: 0.127281, aux_loss_reg: 0.838167, rpn_loc_loss: 1.720316, rpn_cls_loss: 0.714054, rpn_dir_loss: 0.138478, loss_cls: 2.433862, loss: 5.972157
2024-04-12 04:19:50,064 - INFO - epoch[1][80/1856]: lr: 0.000300, aux_loss_cls: 0.114789, aux_loss_reg: 0.834870, rpn_loc_loss: 1.586653, rpn_cls_loss: 0.632630, rpn_dir_loss: 0.140284, loss_cls: 2.112431, loss: 5.421657
